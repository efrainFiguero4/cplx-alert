{"version":3,"file":"cplx-autocomplete.js","sources":["ng://cplx-autocomplete/lib/cplx-autocomplete.service.ts","ng://cplx-autocomplete/lib/cplx-autocomplete.component.ts","ng://cplx-autocomplete/lib/cplx-autocomplete.module.ts","ng://cplx-autocomplete/public-api.ts","ng://cplx-autocomplete/cplx-autocomplete.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class CplxAutocompleteService {\n\n  constructor() { }\n}\n","import { Component, OnInit, Input, HostListener, PipeTransform, Pipe, Output, EventEmitter, ElementRef, ViewChild, OnChanges, SimpleChanges, forwardRef } from '@angular/core';\nimport { isNullOrUndefined } from 'util';\nimport { fromEvent } from 'rxjs';\nimport { of } from \"rxjs\";\nimport { debounceTime, map, distinctUntilChanged, filter } from \"rxjs/operators\";\nimport { NgModel, NG_VALUE_ACCESSOR, ControlValueAccessor, FormGroup, FormControl, Validators } from '@angular/forms';\n\n@Pipe({ name: 'filter' })\nexport class FilterPipe implements PipeTransform {\n\ttransform(items: any[], searchText: string, visible: boolean, params?: string[]): any {\n\t\tif (!items) return [];\n\t\tif (!searchText || !visible) return items;\n\n\t\tif (!isNullOrUndefined(params) && params.length > 0)\n\t\t\treturn items.filter((data) => new RegExp(searchText, 'gi').test(data[\"search\"]));\n\t}\n\n\tmatchValue(data: any[], value: string) {\n\t\treturn Object.keys(data).map((key) => {\n\t\t\treturn new RegExp(value, 'gi').test(data[key]);\n\t\t}).some(result => result);\n\t}\n\n\tmatchValueParams(data: any[], value: string, params: string[]) {\n\t\treturn params.map((key) => {\n\t\t\treturn new RegExp(value, 'gi').test(data[key]);\n\t\t}).some(result => result);\n\t}\n}\n\n\nconst noop = () => {\n};\n\nexport const CUSTOM_INPUT_CONTROL_VALUE_ACCESSOR: any = {\n\tprovide: NG_VALUE_ACCESSOR,\n\tuseExisting: forwardRef(() => CplxAutocompleteComponent),\n\tmulti: true\n};\n\n@Component({\n\tselector: 'cplx-autocomplete',\n\ttemplateUrl: './cplx-autocomplete.html',\n\tstyleUrls: ['./cplx-autocomplete.css'],\n\tproviders: [CUSTOM_INPUT_CONTROL_VALUE_ACCESSOR]\n})\nexport class CplxAutocompleteComponent implements OnInit, OnChanges, ControlValueAccessor {\n\tconstructor() { }\n\n\tvisible = false;\n\tidcontainer: string;\n\n\t@Input() params: string[];\n\t@Input() data: any[];\n\t@Input() placeholder: string;\n\t@Input() filter: boolean = false;\n\t@Output() selectedObject = new EventEmitter<any>(true);\n\t@Output() textChange = new EventEmitter<String>(true)\n\t@Input() timeout = 500;\n\t@Input() minlength = 2;\n\t@Input() loading = false;\n\t@Input() disabled: boolean = false;\n\t@Input() reflectparam: any;\n\t@Input() reflectvalue: any;\n\t@Input() required = false;\n\n\t@ViewChild('inputSearch', { static: true }) inputSearch: ElementRef;\n\n\tformulario = new FormGroup({\n\t\tvalue: new FormControl(null)\n\t});\n\n\tngOnInit(): void {\n\t\tthis.idcontainer = Math.random().toString().split(\".\")[1];\n\t\tif (!this.filter) {\n\t\t\tfromEvent(this.inputSearch.nativeElement, 'keyup').pipe(\n\t\t\t\tmap((event: any) => {\n\t\t\t\t\treturn event.target.value;\n\t\t\t\t}),\n\t\t\t\tfilter(res => res.length >= this.minlength),\n\t\t\t\tdebounceTime(this.timeout),\n\t\t\t\tdistinctUntilChanged()\n\t\t\t).subscribe((text: string) => {\n\t\t\t\tthis.value = text;\n\t\t\t\tthis.visible = true;\n\t\t\t\tthis.textChange.emit(text);\n\t\t\t\t//this.loading = true;\n\t\t\t});\n\t\t}\n\n\t\tif (this.required) {\n\t\t\tthis.set_validator(this.formulario, \"value\", this.required);\n\t\t}\n\t\tthis.formulario.controls.value.updateValueAndValidity();\n\t}\n\n\tset_validator(formgroup: FormGroup, control: string, required?: boolean) {\n\t\tif (required) formgroup.controls[control].setValidators([Validators.required]);\n\t\telse formgroup.controls[control].clearValidators();\n\t\tformgroup.controls[control].updateValueAndValidity();\n\t}\n\n\tselect(object: any) {\n\t\tthis.selectedObject.emit(object);\n\t\tthis.writeValue(object[this.search]);\n\t\tthis.visible = false;\n\t}\n\n\tpublic search = \"search\";\n\n\tngOnChanges(changes: SimpleChanges): void {\n\t\tthis.completar();\n\t}\n\n\tcompletar() {\n\t\tif (this.data) {\n\t\t\tthis.data.forEach((d) => {\n\t\t\t\tlet items = [];\n\t\t\t\tthis.params.map((key) => {\n\t\t\t\t\titems.push(d[key]);\n\t\t\t\t})\n\t\t\t\td[this.search] = items.join(\" - \");\n\t\t\t});\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (this.data && this.reflectparam && this.reflectvalue && this.filter) {\n\t\t\t\t\tlet object = this.data.filter(d => d[this.reflectparam] == this.reflectvalue)[0];\n\t\t\t\t\tif (!isNullOrUndefined(object)) {\n\t\t\t\t\t\tthis.value = object[this.search];\n\t\t\t\t\t\tthis.selectedObject.emit(object);\n\t\t\t\t\t\tthis.textChange.emit(object[this.reflectparam]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, 200);\n\t\t}\n\t\tthis.formulario.controls.value.updateValueAndValidity();\n\t}\n\n\t@HostListener('window:click', ['$event.target'])\n\tonClick(targetElement: any) {\n\t\tlet clases: string[] = targetElement.className.split(\" \");\n\t\tlet clasecontrol: any[] = clases.filter(clase => clase == 'form-control-search');\n\t\tlet clasecontainer: any[] = clases.filter(clase => clase == this.idcontainer);\n\t\tthis.visible = (clasecontrol.length == 0 || clasecontainer.length == 0) ? false : true;\n\t\tthis.formulario.controls.value.updateValueAndValidity()\n\t}\n\n\tprivate _value: any = '';\n\tget value(): any { return this._value; };\n\n\tset value(v: any) {\n\t\tif (v !== this._value) {\n\t\t\tthis._value = v;\n\t\t\tthis.formulario.controls.value.setValue(v);\n\t\t\tthis.formulario.controls.value.updateValueAndValidity();\n\t\t\tthis.onChange(v);\n\t\t}\n\t}\n\n\twriteValue(value: any) {\n\t\tthis._value = value;\n\t\tthis.formulario.controls.value.setValue(value);\n\t\tthis.formulario.controls.value.updateValueAndValidity();\n\t\tthis.onChange(value);\n\t}\n\n\tonChange = (_: any) => { };\n\tonTouched = () => { };\n\tregisterOnChange(fn: (_: any) => void): void { this.onChange = fn; }\n\tregisterOnTouched(fn: () => void): void { this.onTouched = fn; }\n}\n","import { NgModule } from '@angular/core';\nimport { CplxAutocompleteComponent, FilterPipe } from './cplx-autocomplete.component';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { CommonModule } from '@angular/common';\n\n@NgModule({\n\tdeclarations: [CplxAutocompleteComponent, FilterPipe],\n\timports: [CommonModule, FormsModule, ReactiveFormsModule],\n\texports: [CplxAutocompleteComponent, FilterPipe]\n})\nexport class CplxAutocompleteModule { }\n","/*\n * Public API Surface of cplx-autocomplete\n */\n\nexport * from './lib/cplx-autocomplete.service';\nexport * from './lib/cplx-autocomplete.component';\nexport * from './lib/cplx-autocomplete.module';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":["__decorate"],"mappings":"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"}